# **Diverse Uncertainty Quantification on Image Generation Models**

This repository contains code for evaluating **uncertainty quantification (UQ)** and **diversity** in images generated by different AI models, including **Stable Diffusion, DALL·E, and Imagen-3**. The project utilizes CLIP-based feature extraction and statistical diversity metrics to analyze generated images.

## **Table of Contents**
- [Overview](#overview)
- [Directory Structure](#directory-structure)
- [Installation](#installation)
- [Usage](#usage)
- [Evaluation Metrics](#evaluation-metrics)
- [Results](#results)
- [License](#license)

## **Overview**
This project aims to quantify the uncertainty and diversity of generated images using **feature extraction, statistical metrics, and correlation analysis**. The main steps include:
1. **Feature Extraction**: Using OpenAI's CLIP model to compute feature embeddings of images.
2. **Diversity Calculation**: Computing **mean pairwise distance, variance, and entropy** of image embeddings.
3. **Uncertainty Quantification**: Combining diversity metrics into an overall uncertainty score.
4. **Model Comparison**: Analyzing results across Stable Diffusion, DALL·E, and Imagen-3 models.

## **Directory Structure**
```
ahamed14051-diverse-uq/
│── 00-UQ-on-images-Stable-Diffusion.ipynb    # UQ analysis for Stable Diffusion
│── 01-UQ-on-images-DALLE.ipynb               # UQ analysis for DALL·E
│── 02-UQ-on-images-Imagen-3.ipynb            # UQ analysis for Imagen-3
│── 11-Stable-diffusion-image.ipynb           # Image generation via Stable Diffusion
│── 12-Dalle-image.ipynb                       # Image generation via DALL·E
│── 13-Gemini-image.ipynb                      # Image generation via Gemini
│── diversity.py                               # Diversity computation functions
│── features.py                                # Feature extraction using CLIP and LPIPS
│── visualize.py                               # Visualization tools for image comparison
```

## **Installation**
1. Clone this repository:
   ```sh
   git clone https://github.com/YOUR_USERNAME/ahamed14051-diverse-uq.git
   cd ahamed14051-diverse-uq
   ```
2. Install dependencies:
   ```sh
   pip install -r requirements.txt
   ```
   **Note:** Ensure you have a GPU-enabled PyTorch installation if using CUDA.

## **Usage**

### **Feature Extraction & Diversity Calculation**
Run the Jupyter notebooks for each model:
```sh
jupyter notebook
```
Open and execute the corresponding `.ipynb` files (e.g., `00-UQ-on-images-Stable-Diffusion.ipynb`) to compute uncertainty and diversity scores.

### **Running Diversity Metrics Separately**
You can compute diversity directly using:
```python
from diversity import DiversityCalculator
features = ...  # Extracted features from CLIP  
diversity_scores = DiversityCalculator.compute_all_scores(features)
```

## **Evaluation Metrics**
The project uses the following diversity and uncertainty measures:
- **Mean Pairwise Distance**: Measures dissimilarity between images.
- **Variance Score**: Captures the spread of feature embeddings.
- **Entropy Score**: Measures uniformity in clustering.
- **Overall Uncertainty Score**: Weighted combination of the above metrics.

## **Results**
Key correlations observed between diversity and uncertainty across different models:
| Model       | Correlation (Uncertainty vs. Diversity) |
|------------|----------------------------------------|
| Stable Diffusion | **0.631** |
| DALL·E           | **0.571** |
| Imagen-3         | **0.268** |

## **License**
This project is licensed under the **MIT License**.

